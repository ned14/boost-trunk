<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta name="Generator" content="Microsoft FrontPage 4.0">
<meta name="Originator" content="Microsoft Word 9">
<link rel="File-List" href="FsmDiscussion_files/filelist.xml">
<title>FSM framework requirements discussion at boost.org</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Andreas Huber</o:Author>
  <o:LastAuthor>Andreas Huber</o:LastAuthor>
  <o:Revision>284</o:Revision>
  <o:TotalTime>1311</o:TotalTime>
  <o:Created>2002-08-19T21:46:00Z</o:Created>
  <o:LastSaved>2002-08-28T20:51:00Z</o:LastSaved>
  <o:Pages>6</o:Pages>
  <o:Words>3067</o:Words>
  <o:Characters>17482</o:Characters>
  <o:Lines>145</o:Lines>
  <o:Paragraphs>34</o:Paragraphs>
  <o:CharactersWithSpaces>21469</o:CharactersWithSpaces>
  <o:Version>9.3821</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal { mso-pagination: widow-orphan; font-size: 12.0pt; font-family: Times New Roman; 
               mso-fareast-font-family: Times New Roman; margin-left: 0cm; 
               margin-right: 0cm; margin-top: 0cm; margin-bottom: .0001pt }
h1           { mso-style-next: Normal; mso-pagination: widow-orphan; page-break-after: avoid; 
               mso-outline-level: 1; font-size: 16.0pt; mso-bidi-font-size: 
               12.0pt; font-family: Times New Roman; mso-font-kerning: 0pt; 
               margin-left: 0cm; margin-right: 0cm; margin-top: 0cm; 
               margin-bottom: .0001pt }
h2           { mso-style-next: Normal; mso-pagination: widow-orphan; page-break-after: avoid; 
               mso-outline-level: 2; font-size: 12.0pt; font-family: Arial; 
               margin-left: 0cm; margin-right: 0cm; margin-top: 0cm; 
               margin-bottom: .0001pt }
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText { mso-pagination: widow-orphan; font-size: 20.0pt; mso-bidi-font-size: 12.0pt; 
               font-family: Times New Roman; mso-fareast-font-family: 
               Times New Roman; font-weight: bold; margin-left: 0cm; 
               margin-right: 0cm; margin-top: 0cm; margin-bottom: .0001pt }
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent { mso-pagination: widow-orphan; font-size: 12.0pt; font-family: Arial; 
               mso-fareast-font-family: Times New Roman; margin-left: 36.0pt; 
               margin-right: 0cm; margin-top: 0cm; margin-bottom: .0001pt }
a:link, span.MsoHyperlink { color: blue; text-decoration: underline; text-underline: single }
a:visited, span.MsoHyperlinkFollowed { color: purple; text-decoration: underline; text-underline: single }
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1 { page: Section1 }
/* List Definitions */
@list l0
	{mso-list-id:631904863;
	mso-list-type:hybrid;
	mso-list-template-ids:-770915334 67698695 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:8.0pt;
	font-family:Wingdings;}
@list l1
	{mso-list-id:686755045;
	mso-list-type:hybrid;
	mso-list-template-ids:-870526302 67698711 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l1:level1
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%1\)";
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;}
@list l2
	{mso-list-id:899748159;
	mso-list-type:hybrid;
	mso-list-template-ids:-1043967826 67698711 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l2:level1
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%1\)";
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;}
@list l3
	{mso-list-id:1075782027;
	mso-list-type:hybrid;
	mso-list-template-ids:2130592984 67698689 67698689 67698689 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l3:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l3:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l4
	{mso-list-id:1290354063;
	mso-list-type:hybrid;
	mso-list-template-ids:1848921894 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l4:level1
	{mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;}
@list l5
	{mso-list-id:1293712024;
	mso-list-type:hybrid;
	mso-list-template-ids:-448379548 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:54.0pt;
	mso-level-number-position:left;
	margin-left:54.0pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l6
	{mso-list-id:1644576584;
	mso-list-type:hybrid;
	mso-list-template-ids:-1018135818 67698695 67698689 67698689 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	mso-ansi-font-size:8.0pt;
	font-family:Wingdings;}
@list l6:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l6:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l7
	{mso-list-id:1852065872;
	mso-list-type:hybrid;
	mso-list-template-ids:1304357410 67698695 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:8.0pt;
	font-family:Wingdings;}
ol           { margin-bottom: 0cm }
ul           { margin-bottom: 0cm }
-->
</style>
</head>

<body lang="EN-US" link="blue" vlink="purple" style="tab-interval:36.0pt">

<div class="Section1">
  <p class="MsoNormal"><span style="font-family:Arial">(c) 2002 Andreas Huber,
  Zurich, Switzerland<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <h1><span style="font-size:20.0pt;mso-bidi-font-size:12.0pt;font-family:Arial">FSM
  framework requirements discussion at boost.org<o:p></o:p></span></h1>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <h1><span style="font-family:Arial">A general-purpose FSM framework…<o:p></o:p></span></h1>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial">… does not exist or is
  at best impractical for a lot of applications. Some FSM applications need
  dynamic configurability, i.e. the ability to compute the layout of a state
  machine from data only available at runtime. For example, see &quot;A Multiple
  Substring Search Algorithm&quot; by Moishe Halibard and Moshe Rubin in June
  2002 issue of CUJ for a good example (unfortunately not available online).
  Such applications tend to employ quite a simple state model because the state
  machine layout is computed by an algorithm rather than designed by a human.
  That is, the resulting state machines are almost always flat and
  non-concurrent and can be implemented with a simple matrix.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial">On the other side of the
  spectrum are human-designed complex state machines fully exploiting all the
  standard features. Naturally, the layout of such machines is known at compile
  time. Using a dynamically configurable framework to implement such state
  machines leads to poor code expressiveness and leaves some design errors
  covered up until runtime.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial">Therefore, it seems that
  there is room for at least two different approaches to a &quot;standard&quot;
  FSM framework. One approach allows for dynamic configurability but is at the
  same time relatively simple. The other approach fixes most of the state
  machine behavior at compile time (I call this fixed-layout) and supports the
  human designer by providing all the standard features (see below). I would
  like to focus on the latter variant, mainly because I think it has a greater
  potential user base and is therefore more appropriate for “boostification”
  (if at all, which is something the discussion should reveal).<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <h1><span style="font-family:Arial">Requirements for a fixed-layout FSM
  framework<o:p></o:p></span></h1>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial">The framework ...<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">1.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">is fully type-safe.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">2.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">does not require the
  use of a code generator. A lot of the existing solutions force you to design
  your statemachine either graphically or in a specialized language. All or part
  of the code is then generated. Behavior generation definitely has its merits,
  but I don't think that it is an option for most situations where I would want
  to employ a state machine.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">3.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">allows for easy
  transformation of a UML statechart into a working statemachine. Vice versa, an
  existing C++ implementation of a state machine should be fairly easy to
  transform into a UML statechart (that's where most code generation solutions
  have their problems).<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">4.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">enforces as much as
  possible at compile time.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">5.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">supports arbitrarily
  complex entry-, exit- and transition-actions.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">6.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">supports arbitrarily
  complex guards depending on the current state and the incoming event.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">7.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">supports transitions
  between arbitrary states.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">8.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">supports hierarchical
  (composite, nested) states.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">9.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">supports concurrent
  states.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">10.<span style="font:7.0pt &quot;Times New Roman&quot;">
  </span></span><![endif]><span style="font-family:Arial">supports shallow/deep
  history.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">11.<span style="font:7.0pt &quot;Times New Roman&quot;">
  </span></span><![endif]><span style="font-family:Arial">delegates all resource
  allocation to the user so that it could be used for applications with hard
  real-time requirements.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">12.<span style="font:7.0pt &quot;Times New Roman&quot;">
  </span></span><![endif]><span style="font-family:Arial">produces a <b>useful</b>
  reaction when a C++ exception is propagated from user code (simply terminating
  is not useful).<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l4 level1 lfo2;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">13.<span style="font:7.0pt &quot;Times New Roman&quot;">
  </span></span><![endif]><span style="font-family:Arial">supports state-local
  storage. This rare (but IMHO very useful) feature stems from the fact that
  resources are often acquired in the entry action of a state and released in
  its exit action. It follows that the current state should be an object, which
  is constructed upon state-entry and destructed upon state-exit (see below).<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <h1><span style="font-family:Arial">Why yet another finite state machine
  framework?<o:p></o:p></span></h1>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial">I had a look at the
  following FSM frameworks:<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l2 level1 lfo4;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">a)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">The framework
  accompanying the book &quot;Practical Statecharts in C/C++&quot; by Miro Samek,
  CMP Books, ISBN: 1-57820-110-1<br>
  see also <a href="http://www.quantum-leaps.com/">http://www.quantum-leaps.com</a><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l2 level1 lfo4;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">b)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">The framework
  accompanying &quot;Rhapsody in C++&quot; by ILogix<br>
  <a href="http://www.ilogix.com/products/rhapsody/rhap_incplus.cfm">http://www.ilogix.com/products/rhapsody/rhap_incplus.cfm</a><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l2 level1 lfo4;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">c)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">The framework
  accompanying the article &quot;State Machine Design in C++&quot;<br>
  <a href="http://www.cuj.com/articles/2000/0005/0005f/0005f.htm?topic=articles">http://www.cuj.com/articles/2000/0005/0005f/0005f.htm?topic=articles</a><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial">None of the frameworks
  satisfies even 8 of the mentioned requirements:<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l1 level1 lfo6;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">a)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Miro Samek’s
  framework fails to satisfy at least 1, 4, 9, 10, 12, 13.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l1 level1 lfo6;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">b)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Rhapsody’s framework
  fails to satisfy at least 1, 2 (not using a code generator with this framework
  is suicide IMHO), 3, 4, 12, 13.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l1 level1 lfo6;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Arial">c)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">The CUJ article
  framework fails to satisfy at least 1, 4, 5, 6, 8, 9, 10, 12, 13.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <h1><span style="font-family:Arial">The example framework<o:p></o:p></span></h1>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <h2>Strengths</h2>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial;mso-bidi-font-weight:bold">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Compact and generic
  implementation.<b><o:p></o:p></b></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial;mso-bidi-font-weight:bold">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Leaves a minimum of
  work to the user.<b><o:p></o:p></b></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial;mso-bidi-font-weight:bold">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Satisfies 11 of the 13
  mentioned requirements (9. and 10. are not yet implemented).<b><o:p></o:p></b></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial;mso-bidi-font-weight:bold">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Strong relationship
  between user code and UML state chart.<b><o:p></o:p></b></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial;mso-bidi-font-weight:bold">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Compile-time discovery
  of the innermost common outer state of the transition source state and the
  target state (traditionally named LCA, least common ancestor).<b><o:p></o:p></b></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial;mso-bidi-font-weight:bold">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Allows for several
  programmers working on the same state machine simultaneously.<b><o:p></o:p></b></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <h2>Weaknesses</h2>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l3 level2 lfo8;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><b><span style="font-family:Arial">Interface</span></b><span style="font-family:Arial">:
  </span><font face="Courier New">state::transit_to()</font><span style="font-family:Arial">
  is called by the </span><font face="Courier New">event_receiver::receive()</font><span style="font-family:Arial">
  overrides to initiate a transition. By design, </span><font face="Courier New">transit_to()</font><span style="font-family:Arial">
  only returns after the destruction of the current state. That is, state
  objects are destructed before control leaves one of their member functions!
  This is similar to executing the statement </span><font face="Courier New">delete
  this;</font><span style="font-family:Arial"> inside a member function and is
  well defined as long as no data members are accessed or virtual functions are
  called afterwards. Although the user should return the return value of </span><font face="Courier New">transit_to()</font><span style="font-family:Arial">
  from a </span><font face="Courier New">receive()</font><span style="font-family:Arial">
  override, there is no absolutely secure way to prevent the user from executing
  more code after calling </span><font face="Courier New">transit_to()</font><span style="font-family:Arial">.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l3 level2 lfo8;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><b><span style="font-family:Arial">Dispatch overhead</span></b><span style="font-family:Arial">:
  Acyclic visitor is used for event dispatch. The framework first tries to send
  the event to the innermost current state, if the innermost state cannot
  consume it (because of a guard or because there is no event handler), the
  framework tries to send it to the leaf states’ immediate outer state. If the
  outer state cannot consume it either, it is sent to the immediate outer states’
  outer state and so on until an outermost state is reached. The cost C (taking
  into account dynamic casts and virtual calls only) to dispatch one event can
  be formalized as follows:<br>
  <br>
  C = (d + 1) dynamic_casts + (g + 2) virtual_calls<br>
  <br>
  where<br>
  <br>
  d = the “level” of the state where the transition originates seen from the
  leaf state. d=0 for the leaf state.<br>
  g = the number of “failed” guards, g &lt;= d<br>
  <br>
  Examples:<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt;text-indent:-18.0pt;mso-list:l7 level1 lfo10;
tab-stops:list 36.0pt"><![if !supportLists]><span style="font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:Wingdings;mso-bidi-font-family:Arial">q<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">The leaf state
  consumes the event -&gt; d = 0, g = 0<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt;text-indent:-18.0pt;mso-list:l7 level1 lfo10;
tab-stops:list 36.0pt"><![if !supportLists]><span style="font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:Wingdings;mso-bidi-font-family:Arial">q<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">The immediate outer
  state of the leaf state consumes -&gt; d = 1, g = 0 or 1<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt;text-indent:-18.0pt;mso-list:l7 level1 lfo10;
tab-stops:list 36.0pt"><![if !supportLists]><span style="font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:Wingdings;mso-bidi-font-family:Arial">q<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">The outermost state A
  contains state B, which contains state C, which contains state D, which
  contains state E, which is the current innermost state. An unguarded
  transition for the incoming event originates at state B. Another transition
  for the incoming event originates at state D, but a guard prevents transition.
  All other states have no transitions for the event. -&gt; d=3, g=1<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt"><span style="font-family:Arial">There
  is a way to considerably reduce dispatch overhead but it doesn't come without
  disadvantages. Instead of deriving from an individual event_receiver instance
  for each event, a typelist with all events could be passed to the state class
  template. The state template then uses something like Alexandrescus </span><font face="Courier New">GenScatterHierarchy</font><span style="font-family:Arial">
  (</span><font face="Courier New">mpl::fold</font><span style="font-family:Arial">
  does something similar I think) to automate derivation from the appropriate </span><font face="Courier New">event_receiver</font><span style="font-family:Arial">
  instantiations. This way inner states could find out which events are handled
  by their outer states and use this information to generate forwarding event
  handlers, so that an event dispatch would always require exactly one </span><font face="Courier New">dynamic_cast</font><span style="font-family:Arial">
  and two virtual calls. An obvious disadvantage of this approach is of course a
  larger memory footprint.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l3 level2 lfo8;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><b><span style="font-family:Arial">State machine
  subclassing</span></b><span style="font-family:Arial">: Frameworks like the
  one accompanying “Rhapsody in C++” allow the user to derive from a state
  machine and augment the machine layout in the derived class. Transitions and
  states can be added.<br>
  Because the example framework has no global transition table and transition
  code is distributed among all states, there is no easy way to achieve the
  same. The machine layout is essentially fixed in the base class. However,
  actions can always be customized in a derived class by other means (template
  method pattern, function objects, …).<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <h2>Missing facilities</h2>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">The framework is
  currently supporting single-threaded use only.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">In-state reactions are
  not yet directly supported but can easily be realized by coding them directly
  into the event handler and having it return true.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <h2>Design rationale</h2>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><b><span style="font-family:Arial">State-local storage</span></b><span style="font-family:Arial">:
  In most existing FSM frameworks the whole state machine runs in <b>one</b>
  global environment (context). That is, all resource handles and variables
  local to the state machine are stored in one place (normally as members of the
  class that also derives from some state machine base class). For large state
  machines this often leads to the class having a huge number of data members
  most of which are needed only briefly in a tiny part of the machine. This is
  where state-local storage comes in: All data can be located where it is needed
  and can have as small or big a scope as desired. A states’ context thus
  consists of all its direct and indirect outer states and the state machine.
  This also allows for multiple programmers working on the same machine
  simultaneously without disturbing each other too much.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><b><span style="font-family:Arial">Member- vs.
  non-member user functions</span></b><span style="font-family:Arial">: Event
  handlers (the </span><font face="Courier New">event_receiver::receive()</font><span style="font-family:Arial">
  overrides) as well as entry-, exit- and transition-functions must be
  non-static members. This is seems inflexible at first but I don’t think that
  relaxing this (e.g. by allowing function objects) would add a lot of value. By
  design, entry- and exit-actions (mapped to constructor and destructor) must be
  members anyway. Since event handlers can contain guards depending on state
  data members, the current state would have to be passed to the event handler
  function as parameter in any case. The same is true for transition actions.
  However, a transition action must not necessarily be a member of the LCA, it
  can also be a member of a direct or indirect outer context of the LCA.<br>
  This way most of the reaction behavior of a state is also concentrated in the
  state class itself and cannot be scattered all over (as is sometimes the case
  with traditional frameworks).<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><b><span style="font-family:Arial">Exception handling
  rationale</span></b><span style="font-family:Arial">: Traditionally, user code
  posted a special event to the state machine upon detection of a runtime error
  that was later handled in much the same way as any other event. In the era of
  “error-code-return” exception handling this was no big deal, as
  programmers were accustomed to propagate errors manually and posting an event
  instead of returning an error code is not really more work. With C++ exception
  handling however, error propagation is supposed to happen mostly <b>automatically</b>.
  Requiring framework-called user functions to convert exceptions into
  appropriate events is simply falling back into a cumbersome and error-prone
  routine humans were never really good at. In fact, doing so with the example
  framework would be a sure way into disaster as this could lead to a state
  being entered without its outer state being entered properly.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><b><span style="font-family:Arial">Exception behavior</span></b><span style="font-family:Arial">:<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo14;
tab-stops:list 36.0pt"><![if !supportLists]><span style="font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:Wingdings;mso-bidi-font-family:Arial">q<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">A policy passed to the
  state machine class template specifies how to convert all exceptions
  propagated from user code.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo14;
tab-stops:list 36.0pt"><![if !supportLists]><span style="font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:Wingdings;mso-bidi-font-family:Arial">q<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Except from
  exit-actions (mapped to state-destructors), exceptions can be propagated from
  all user functions. However, for this to work properly, event handlers must be
  exception neutral (otherwise </span><font face="Courier New">state::transit_to()</font><span style="font-family:Arial">
  would have to use the policy as well, which could lead to massive code-bloat).<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo14;
tab-stops:list 36.0pt"><![if !supportLists]><span style="font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:Wingdings;mso-bidi-font-family:Arial">q<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Exception events
  always have absolute priority over all other events.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo14;
tab-stops:list 36.0pt"><![if !supportLists]><span style="font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:Wingdings;mso-bidi-font-family:Arial">q<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Exceptions thrown
  inside event handlers are converted to an exception event and then sent to the
  current state.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo14;
tab-stops:list 36.0pt"><![if !supportLists]><span style="font-size:8.0pt;
mso-bidi-font-size:12.0pt;font-family:Wingdings;mso-bidi-font-family:Arial">q<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Exceptions can of
  course also be thrown when the state machine is in the middle of a transition.
  If an entry action throws an exception, the generated exception event is sent
  to the last successfully entered state. If a transition-action throws an
  exception, the event is sent to the LCA. In both cases the state-machine is
  not in a stable state and leaving it there (e.g. by ignoring the exception
  event) would violate an important invariant of state machines. So, the
  exception event handler <b>must</b> either make a transition or terminate to
  bring the machine back into a stable state. That’s why the framework checks
  that the state machine is always in a stable state after processing an
  exception event. The state machine is simply terminated, if this is not the
  case.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:18.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 18.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><b><span style="font-family:Arial">Resource handling</span></b><span style="font-family:Arial">:
  For hard-realtime applications it is important to either avoid executing
  possibly non-deterministic actions or at least to define <b>when</b> they are
  executed. The example framework news and deletes state objects, deletes event
  objects and uses a queue to store event pointers. As almost all out-of-the-box
  C++ memory allocators are non-deterministic and are notoriously slow too,
  speed-hungry and hard-realtime applications will typically replace the state
  class template with their own optimized version. This can be as easy as
  inheriting a </span><font face="Courier New">my_state</font><span style="font-family:Arial">
  class template from the framework-supplied </span><font face="Courier New">state</font><span style="font-family:Arial">
  template and your preferred small-object/deterministic/constant-time allocator
  base class. The same can be done with the </span><font face="Courier New">event</font><span style="font-family:Arial">
  class template. For the event queue, memory allocation can be controlled by
  passing as </span><font face="Courier New">state_machine</font><span style="font-family:Arial">
  template parameter a class providing the same interface as </span><font face="Courier New">std::queue</font><span style="font-family:Arial">.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><b><span style="font-family:Arial">Documentation<o:p></o:p></span></b></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">template&lt;
  class Event &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><b><span style="font-family:&quot;Courier New&quot;">class
  event_receiver<o:p></o:p></span></b></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">{<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;
  </span>protected:<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>event_receiver();<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>~event_receiver();<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;
  </span>private:<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>virtual<span style="mso-bidi-font-style:
italic"> const bool </span>receive( const Event &amp; the Event ) = 0;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">};<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoBodyTextIndent">A state deriving from this class template
  indicates that it may handle events of the type passed as template parameter.</p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;;mso-bidi-font-style:
italic">const bool </span><b><span style="font-family:&quot;Courier New&quot;">event_receiver::receive</span></b><span style="font-family:&quot;Courier New&quot;">(
  const Event &amp; the Event )<b><o:p></o:p></b></span></p>
  <p class="MsoNormal"><b><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">Requirements:<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:54.0pt;text-indent:-18.0pt;mso-list:l6 level3 lfo12;
tab-stops:list 54.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Override must be
  exception-neutral.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:54.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 54.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Override returns true
  if the event has been consumed, returns false otherwise.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">Typical
  override actions:<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:54.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 54.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Check the guard (if
  there is one) and return false if the state cannot handle the event.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:54.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 54.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Return
  state::transit_to() to make a transition.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:54.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 54.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Return
  state::terminate() to bring the state machine into the terminated state.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:54.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 54.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Execute in-state
  reactions and return true.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:54.0pt;text-indent:-18.0pt;mso-list:l6 level2 lfo12;
tab-stops:list 54.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">Throw or propagate an
  exception.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><b><span style="font-family:&quot;Courier New&quot;">class
  event_base</span></b><span style="font-family:&quot;Courier New&quot;"> :
  boost::noncopyable<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">{<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;
  </span>public:<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>virtual ~event_base();<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;
  </span>protected:<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>event_base();<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">};<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">template&lt;
  class Derived &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><b><span style="font-family:&quot;Courier New&quot;">class
  event</span></b><span style="font-family:&quot;Courier New&quot;"> : public
  event_base<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">{<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;
  </span>protected:<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>event();<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">};<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoBodyTextIndent">All events must directly or indirectly derive
  from this class template and pass the most derived class as template
  parameter.</p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">template&lt;
  class Derived,<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>class Context,<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>class InnerInitial = <i><u>unspecified</u></i> &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><b><span style="font-family:&quot;Courier New&quot;">class
  state<o:p></o:p></span></b></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">{<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;
  </span>protected:<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>typedef state base_type;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>typedef <i><u>unspecified</u></i> context_ptr_type;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>state( context_ptr_type pContext );<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>template&lt; class Context &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>Context &amp; context();<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>template&lt; class Context &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>const Context &amp; context() const;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>template&lt; class NextState &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>const bool transit_to();<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>template&lt; class NextState, class TransitionContext, class Event &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>const bool transit_to(<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>void ( TransitionContext::*pTransitionAction )( const Event &amp; ),<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>const Event &amp; theEvent );<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>const bool terminate();<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>void post_event( std::auto_ptr&lt; const event_base &gt; pEvent );<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">};<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">All
  states must directly or indirectly derive from this class template and pass
  the most derived class as the first template parameter. The second template
  parameter defines the state’s context, which is either a </span><span style="font-family:
&quot;Courier New&quot;">state_machine</span><span style="font-family:Arial">
  subclass (meaning that the state is a top state) or another </span><font face="Courier New">state</font><span style="font-family:Arial">
  subclass (meaning that this state is nested inside the other state). The third
  template parameter is optional and specifies the initial nested state, which
  may be an incomplete type.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">State
  entry actions may be executed in the subclass constructor. State exit actions
  may be executed in the subclass destructor. The subclass destructor must not
  throw.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><b><span style="font-family:&quot;Courier New&quot;">state::state</span></b><span style="font-family:&quot;Courier New&quot;">(
  context_ptr_type pContext )<b><o:p></o:p></b></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoBodyTextIndent">The derived class must have exactly one
  constructor with exactly the same signature, which simply passes the parameter
  through to this constructor. Does not throw.</p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">template&lt;
  class Context &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">Context
  &amp; <b>state::context</b>();<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoBodyTextIndent">Returns a reference to a direct or indirect outer
  context of this state (which may be another state or a state machine). Does
  not throw.</p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">template&lt;
  class Context &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">const
  Context &amp; <b>state::context</b>() const;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoBodyTextIndent">Returns a const reference to a direct or indirect
  outer context of this state (which may be another state or a state machine).
  Does not throw.</p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">template&lt;
  class NextState &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">const
  bool <b>state::transit_to</b>();<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">Makes
  a transition to the state passed as template parameter and returns true. Must
  only be called from overrides of </span><span style="font-family:&quot;Courier New&quot;">event_receiver::receive()</span><span style="font-family:Arial">.
  The caller must return immediately after calling this function. Throws
  exceptions propagated from </span><span style="font-family:
&quot;Courier New&quot;">operator new</span><span style="font-family:Arial">
  (either </span><span style="font-family:&quot;Courier New&quot;">std::bad_alloc</span><span style="font-family:
Arial"> or exceptions propagated from user-defined </span><span style="font-family:&quot;Courier New&quot;">operator
  new</span><span style="font-family:
Arial">) and exceptions propagated from state constructors.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">template&lt;
  class NextState, class TransitionContext, class Event &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">const
  bool <b>state::transit_to</b>(<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;
  </span>void ( TransitionContext::*pTransitionAction )( const Event &amp; ),<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;
  </span>const Event &amp; theEvent );<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">Makes
  a transition to the state passed as template parameter and returns true.
  During the transition, the transition action passed as first parameter is
  called with the event passed as second parameter. The transition function can
  be a member of either the LCA or any direct or indirect context of the LCA.
  Must only be called from overrides of </span><span style="font-family:&quot;Courier New&quot;">event_receiver::receive()</span><span style="font-family:Arial">.
  The caller must return immediately after calling this function. Throws
  exceptions propagated from </span><span style="font-family:
&quot;Courier New&quot;">operator new</span><span style="font-family:Arial">
  (either </span><span style="font-family:&quot;Courier New&quot;">std::bad_alloc</span><span style="font-family:
Arial"> or exceptions propagated from user-defined </span><span style="font-family:&quot;Courier New&quot;">operator
  new</span><span style="font-family:
Arial">) and exceptions propagated from state constructors and the passed
  transition action.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">const
  bool <b>state::terminate</b>();<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">Terminates
  the state machine and returns true. Must only be called from overrides of </span><span style="font-family:&quot;Courier New&quot;">event_receiver::receive()</span><span style="font-family:Arial">.
  The caller must return immediately after calling this function. Does not
  throw.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">void <b>state::post_event</b>(
  std::auto_ptr&lt; const event_base &gt; pEvent );<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">Queues
  a new event in the state machine event queue. Can be called from any user
  function. Throws exceptions propagated from </span><span style="font-family:
&quot;Courier New&quot;">EventQueue::push()</span><span style="font-family:Arial">
  (see </span><span style="font-family:&quot;Courier New&quot;">state_machine</span><span style="font-family:
Arial">).<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">template&lt;
  class Derived,<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>class ExceptionTranslator = simple_exception_translator&lt;&gt;,<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>class EventQueue = std::queue&lt; const event_base * &gt; &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">class <b>state_machine</b>
  : boost::noncopyable<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">{<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;
  </span>protected:<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>typedef state_machine base_type;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>template&lt; class InitialState &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>state_machine( const InitialState * );<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>~state_machine();<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>void process_event( const event_base &amp; evt );<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>template&lt; class State &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>const State &amp; current_state() const;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>template&lt; class State &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>const State * const current_state_ptr() const;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">};<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">All
  states machines must directly or indirectly derive from this class template
  and pass the most derived class as the first template parameter. The optional
  second template parameter specifies how exceptions propagated from user code
  should be translated into events. The optional third template parameter
  specifies what should be used as event queue.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">template&lt;
  class InitialState &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><b><span style="font-family:&quot;Courier New&quot;">state_machine::state_machine</span></b><span style="font-family:&quot;Courier New&quot;">(
  const InitialState * );</span><span style="font-family:Arial"><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">Because
  there’s no way to call a parameterless template constructor, the subclass
  must pass the initial state as a pointer. The state machine is <b>not</b>
  started yet!<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><b><span style="font-family:&quot;Courier New&quot;">state_machine::~state_machine</span></b><span style="font-family:&quot;Courier New&quot;">();</span><span style="font-family:Arial"><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoBodyTextIndent">Terminates the state machine, i.e. exits all
  current states.</p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">void <b>state_machine::process_event</b>(
  const event_base &amp; evt );<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">If
  the function is called for the first time after state machine construction,
  the initial state is entered first. Processes the passed event and all
  internal events that were posted as a result of this. If an exception is
  propagated from user code, the second class template parameter is used to
  convert the exception into an exception event. The exception event is
  processed immediately (it has absolute priority over posted events). It
  depends on the situation which state the exception event is sent to:<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:54.0pt;text-indent:-18.0pt;mso-list:l5 level1 lfo16;
tab-stops:list 54.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">The exception was
  thrown inside a event_receiver::receive() override: The exception event is
  sent to the current state.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:54.0pt;text-indent:-18.0pt;mso-list:l5 level1 lfo16;
tab-stops:list 54.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">The exception was
  propagated from a state constructor: The exception event is sent to the last
  successfully entered (constructed) state.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:54.0pt;text-indent:-18.0pt;mso-list:l5 level1 lfo16;
tab-stops:list 54.0pt"><![if !supportLists]><span style="font-family:Symbol;
mso-bidi-font-family:Arial">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><![endif]><span style="font-family:Arial">The exception was
  propagated from a transition function: The exception event is sent to the LCA.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">Because
  the state machine is not stable in the last two cases, the exception event
  handler <b>must</b> then either make a transition or terminate. The state
  machine is terminated automatically if this is not the case.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">template&lt;
  class State &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">const
  State &amp; <b>state_machine::current_state</b>() const;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">Returns
  a const reference to the state identified by the template parameter <b>if</b>
  the state machine is currently in this state. Throws </span><span style="font-family:&quot;Courier New&quot;">std::bad_cast</span><span style="font-family:
Arial"> otherwise.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">template&lt;
  class State &gt;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">const
  State * const <b>state_machine::current_state_ptr</b>() const;<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-left:36.0pt"><span style="font-family:Arial">Returns
  a pointer to the state identified by the template parameter <b>if</b> the
  state machine is currently in this state. Returns 0 otherwise.<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="font-family:Arial"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
</div>

</body>

</html>
