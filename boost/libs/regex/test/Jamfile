subproject libs/regex/test ;

# bring in the rules for testing
SEARCH on testing.jam = $(BOOST_BUILD_PATH) ;
include testing.jam ;

local test-dir = $(BOOST_ROOT)$(SLASH)libs$(SLASH)regex$(SLASH)test$(SLASH)regress$(SLASH) ;

local test-files = $(test-dir)tests.txt
  # dwa -- not sure if this is generally applicable
  #  $(test-dir)test1252.txt
  ;

        test-suite regex
        : [ run regress/parse.cpp regress/regress.cpp regress/tests.cpp
                    <lib>../build/boost_regex 
                    <lib>../../test/build/boost_prg_exec_monitor
           : 
                    $(test-files)
           : 
           : 
                    <define>BOOST_REGEX_NO_LIB=1
                    <define>BOOST_REGEX_STATIC_LINK=1
           :
                    regress ]

            [ run regress/parse.cpp lregress/regress.cpp regress/tests.cpp
                    <lib>../build/boost_regex 
                    <lib>../../test/build/boost_prg_exec_monitor
            : 
                    $(test-files)
            : 
            : 
                    <define>BOOST_REGEX_NO_LIB=1
                    <define>TEST_UNICODE=1
                    <define>BOOST_REGEX_STATIC_LINK=1
            :
                    wregress ]

            [ run c_compiler_checks/posix_api_check.c
                    <lib>../build/boost_regex
            : 
            : 
            : 
                    <define>BOOST_REGEX_NO_LIB=1
                    <define>BOOST_REGEX_STATIC_LINK=1
            :
                    posix_api_check_c ]

            [ run c_compiler_checks/wide_posix_api_check.c
                    <lib>../build/boost_regex 
            : 
            : 
            : 
                    <define>BOOST_REGEX_NO_LIB=1
                    <define>BOOST_REGEX_STATIC_LINK=1
            :
                    wide_posix_api_check_c ]

            [ run c_compiler_checks/posix_api_check.cpp
                    <lib>../build/boost_regex 
            : 
            : 
            :
                    <define>BOOST_REGEX_NO_LIB=1
                    <define>BOOST_REGEX_STATIC_LINK=1
            ]

            [ run c_compiler_checks/wide_posix_api_check.cpp
                    <lib>../build/boost_regex
            : 
            : 
            : 
                    <define>BOOST_REGEX_NO_LIB=1
                    <define>BOOST_REGEX_STATIC_LINK=1
            ]
;

