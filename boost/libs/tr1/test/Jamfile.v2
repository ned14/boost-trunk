# Copyright John Maddock 2005

# bring in the rules for testing
import testing ;

#
# define the sources which need testing, mostly this is just
# all the files *_test.cpp, but any badly named examples can 
# be added to this list :-)
#
            
# this rule enumerates through all the sources and invokes
# the run rule for each source, the result is a list of all
# the run rules, which we can pass on to the test_suite rule:
rule test_all
{
   #ECHO executing test_all rule ;
   local all_rules = ;
   for local file in [ GLOB . : test*.cpp ]
   {
      all_rules += [ compile $(file) ] ;
      all_rules += [ compile $(file) 
         : <include>../../../boost/tr1/tr1 
           <include>../../../boost/tr1/tr1/bcc32 
           <define>TEST_STD_HEADERS=1 
         : std_$(file:B) ] ;
   }
   for local file2 in [ GLOB ../../config/test : has_tr1*fail.cpp ]
   {
      all_rules += [ compile-fail $(file2) ] ;
   }
   #ECHO $(all_rules) ;
   return $(all_rules) ;
}

test-suite tr1 : [ test_all r ] ; 





