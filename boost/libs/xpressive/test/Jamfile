# xpressive library test Jamfile

# Copyright Eric Niebler 2004

# Use, modification, and distribution is subject to the Boost Software
# License, Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
# http://www.boost.org/LICENSE_1_0.txt)

subproject libs/xpressive/test ;

# bring in rules for testing
import testing ;

# A bug in the Win32 intel compilers causes compilation of one of our
# tests to take forever when debug symbols are enabled. This rule
# turns them off when added to the requirements section
local rule turn-off-intel-debug-symbols ( toolset variant : properties * )
{
    if $(NT) && [ MATCH (.*intel.*) : $(toolset) ]
    {
        properties = [ difference $(properties) : <debug-symbols>on ] <debug-symbols>off ;
    }
    return $(properties) ;
}

# Make tests run by default.
DEPENDS all : test ;

{
    test-suite "xpressive"
        : [ run test1.cpp : : : turn-off-intel-debug-symbols ]
          [ run test2.cpp : : : turn-off-intel-debug-symbols ]
          [ run test3.cpp : : : turn-off-intel-debug-symbols ]
          [ run test4.cpp : : : turn-off-intel-debug-symbols ]
          [ run test5.cpp : : : turn-off-intel-debug-symbols ]
          [ run test6.cpp : : : turn-off-intel-debug-symbols ]
          [ run test7.cpp : : : turn-off-intel-debug-symbols ]
          [ run test8.cpp : : : turn-off-intel-debug-symbols ]
          [ run test9.cpp : : : turn-off-intel-debug-symbols ]
          [ run test1u.cpp : : : turn-off-intel-debug-symbols ]
          [ run test2u.cpp : : : turn-off-intel-debug-symbols ]
          [ run test3u.cpp : : : turn-off-intel-debug-symbols ]
          [ run test4u.cpp : : : turn-off-intel-debug-symbols ]
          [ run test5u.cpp : : : turn-off-intel-debug-symbols ]
          [ run test6u.cpp : : : turn-off-intel-debug-symbols ]
          [ run test7u.cpp : : : turn-off-intel-debug-symbols ]
          [ run test8u.cpp : : : turn-off-intel-debug-symbols ]
          [ run test9u.cpp : : : turn-off-intel-debug-symbols ]
          [ run misc1.cpp : : : turn-off-intel-debug-symbols ]
          [ run test_cycles.cpp : : : turn-off-intel-debug-symbols ]
          [ run test_non_char.cpp : : : turn-off-intel-debug-symbols ]
          [ run test_static.cpp : : : turn-off-intel-debug-symbols ]
          [ run test_dynamic.cpp : : : turn-off-intel-debug-symbols ]
          [ link multiple_defs1.cpp multiple_defs2.cpp : : multiple_defs ]
          [ compile test_basic_regex.cpp ]
          [ compile test_match_results.cpp ]
          [ compile test_regex_algorithms.cpp ]
          [ compile test_regex_compiler.cpp ]
          [ compile test_regex_constants.cpp ]
          [ compile test_regex_error.cpp ]
          [ compile test_regex_iterator.cpp ]
          [ compile test_regex_primitives.cpp ]
          [ compile test_regex_token_iterator.cpp ]
          [ compile test_regex_traits.cpp ]
          [ compile test_sub_match.cpp ]
        ;
}
