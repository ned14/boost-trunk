<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>New Page 1</title>
</head>

<body>

$id frontmatter=
  <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="579">
    <tr>
      <td width="153" align="left" valign="top">Document number:</td>
      <td width="426"><span style="background-color: #FFFF00">D3335=12-0025</span></td>
    </tr>
    <tr>
      <td width="153" align="left" valign="top">Date:</td>
      <td width="426">
      <!--webbot bot="Timestamp" S-Type="EDITED" S-Format="%Y-%m-%d" startspan -->2012-01-11<!--webbot bot="Timestamp" endspan i-checksum="12041" --></td>
    </tr>
    <tr>
      <td width="153" align="left" valign="top">Project:</td>
      <td width="426">Programming Language C++, Library Working Group</td>
    </tr>
    <tr>
      <td width="153" align="left" valign="top">Reply-to:</td>
      <td width="426">Beman Dawes &lt;bdawes at acm dot org&gt;</td>
    </tr>
  </table>


<h1>Filesystem Library for C++11/TR2 (Revision 1)</h1>


<p>This paper proposes that the&nbsp;filesystem library component of <i>C++ Standard 
Library Technical Report 2</i> be based on Version 3 of the Boost Filesystem 
Library (see <a href="http://www.boost.org/libs/filesystem">
www.boost.org/libs/filesystem</a>). Preliminary wording is provided. A
<a href="#TODO">TODO</a> list identifies remaining work to be done.</p>


<p><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1975.html">
J16/06-0045 = WG21/N1975</a>, Filesystem Library Proposal for TR2 (Revision 3), 
was adopted by the committee in April, 2006, at the Berlin meeting. Shortly 
afterward the Library Working Group set aside work on TR2 to concentrate on 
C++0x. In the meantime, work on the Boost version of the Filesystem Library has 
continued, and Version 3 of the library has been released. Changes include:</p>


  <ul>
    <li>A single class <code>path</code> handles all aspects of 
    internationalization, replacing the previous template and its <code>path</code> 
    and <code>wpath</code> instantiations. Character types <code>char</code>,
    <code>wchar_t</code>, <code>char16_t</code>, and <code>char32_t</code> are 
    supported. This is a major simplification of the path abstraction, 
    particularly for functions that take path arguments. This change was based 
    on a suggestion by Peter Dimov.<br>
&nbsp;</li>
    <li>Several operational functions have been added, including much better 
    symlink support, the ability to resize a file, and the ability to generate a 
    unique path.<br>
&nbsp;</li>
    <li>Support for error reporting via <code>error_code</code> is now uniform 
    throughout the operations functions.|<br>
&nbsp;</li>
    <li>Several functions have been renamed, based on feedback from users.</li>
  </ul>


<h2>Motivation and Scope</h2>


<p>The motivation and scope for a filesystem library were described in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1975.html">
N1975</a>, and are not repeated here. A minor scope reduction is that an 
addition to the current C++ runtime library is no longer needed.</p>


<p>Boost Filesystem Version 3  introduced a single path type that interoperates well with both <code>
basic_string</code> and user defined string types. Thus the following Design 
alternatives paragraph is no long applicable:</p>


  <blockquote>


<p><strike><i>Single path type which can at runtime accept narrow or wide character 
pathnames.</i> Although certainly interesting, and possibly superior, such a 
design would not interoperate well with the current Standard Library's 
compile-time typed <code>basic_string</code>. A new runtime polymorphic string 
class would be the best place to experiment with this concept, not a path class.</strike></p>


  </blockquote>


  <h2><a name="TODO">TODO</a></h2>
  <ul>
    <li>Apply C++0X features. Boost.Filesystem needs to implement these to verify their 
    application is correct.</li>
    <li>Boost.Filesystem needs to implement <code>char16_t</code> and <code>char32_t</code> support to verify the 
    specification for these is correct.</li>
    <li>Class <code>file_status</code> is overdesigned. It holds just a single <code>file_type</code> variable, and that's unlikely to change 
  because of performance considerations. It would be simpler to eliminate class <code>
  file_status</code>, and just use <code>file_type</code> in its stead. Perhaps 
    rename to <code>file_status</code>. This hasn't been done in the Boost 
    because it would break existing code, albeit noisily.</li>
    <li>Replace path inserter and extractor <i>Effects</i> with prose, since the 
    current wording relies on 
  <code>boost::io::quoted</code></span>.</li>
    <li>Replace uses of <code>boost::iterator_facade</code>.</li>
    <li><code><a href="#Source">Source</a></code> is not specified as actually 
    implemented. Expose <code>path_traits</code>?</li>
    <li><i>Effects</i> for <code>copy</code> and <code>copy_directory</code> 
    need to be reviewed, revised, tested.</li>
    <li>Review changes to header &lt;fstream&gt;</li>
  </ul>
  
  <h2>Revisions</h2>
  <p>TBS</p>
  
$endid

$id wording_prefix=
<h2>Proposed Wording</h2>

<p><span style="font-style: italic; background-color: rgb(224, 224, 224);">
Gray-shaded italic text is commentary on the proposal. It is not to be added to 
the TR.</span></p>
<blockquote>
  <table style="border-collapse: collapse" bgcolor="#E0E0E0" border="1" bordercolor="#111111" cellpadding="7" cellspacing="0">
    <tr>
      <td><span style="font-style: italic; ">The following wording is a lighted 
      edited version of the Boost Filesystem reference documentation. Although 
      further editing is required, the features described are relatively stable 
      and major feature changes are not anticipated. </span></td>
    </tr>
  </table>
</blockquote>
<p><span style="font-style: italic; background-color: #E0E0E0">Add the following 
to the Technical Report's front matter:</span></p>
<p>The following standard contains provisions which, through reference in this 
text, constitute provisions of this Technical Report. At the time of 
publication, the editions indicated were valid. All standards are subject to 
revision, and parties to agreements based on this Technical Report are 
encouraged to investigate the possibility of applying the most recent editions 
of the standard indicated below. Members of IEC and ISO maintain registers of 
currently valid International Standards.</p>
<ul>
  <li>ISO/IEC 9945:2003, <i>Portable Operating System Interface (POSIX<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1975.html#Footnote-1"><sup>1</sup></a>), 
  part 1 (Base Definitions) and part 2 (System Interfaces)</i>, both as 
  corrected by their respective 2004 Correction 1 documents.<p>[<i>Note:</i> 
  ISO/IEC 9945:2003 is also IEEE&nbsp;Std&nbsp;1003.1-2001, and The Open Group Base 
  Specifications, Issue 6, and is also known as The Single Unix<font face="Times New Roman"><sup><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1975.html#Footnote-2">2</a></sup><i><b>
  </b></i>Specification, Version 3. It is available from each of those 
  organizations, and may be read online or downloaded from
  <a href="http://www.unix.org/single_unix_specification/">
  www.unix.org/single_unix_specification/</a> <i>-- end note</i>]</font></li>
</ul>
<p>ISO/IEC 9945:2003, with the indicated corrections, is hereinafter called <i>
POSIX</i>.</p>
<p><a name="Footnote-1">Footnote 1</a>: <i>POSIX</i>® is a registered trademark 
of The IEEE.</p>
<p><a name="Footnote-2">Footnote 2</a>: <i>UNIX</i>® is a registered trademark 
of The Open Group.</p>
<p><span style="font-style: italic; background-color: #E0E0E0">Add the following 
to the Technical Report as a new Clause:</span></p>
<h2>Filesystem Library</h2>

$endid

$id wording_suffix=

<span style="font-style: italic; background-color: rgb(224, 224, 224);">
End of proposed wording.</span>
<hr>
$endid

$id backmatter=
$endid
 
</body>

</html>